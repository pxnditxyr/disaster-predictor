---
import { Icon } from 'astro-icon/components'

---

<div class="flex justify-center items-center min-h-screen">
  <div class="w-full max-w-2xl shadow-lg rounded-3xl p-8">
    <div class="space-y-12">
      <div class="text-3xl font-bold text-[#008B8B] text-center flex items-center justify-center">
        ComunÃ­cate con nosotros â˜ï¸
      </div>
      <div class="text-[#20B2AA] text-center text-lg font-semibold">
        ğŸ¼ Completa el formulario para ponerte en contacto con nosotros ğŸˆ
      </div>
    </div>
    <div class="mt-12">
      <form id="contact-form">
        <div class="grid w-full items-center gap-8">
          <div class="flex flex-col space-y-4">
            <label for="name" class="text-[#008B8B] text-lg font-semibold flex items-center">
              <Icon name="profile" size={ 24 } class="mr-2" />
              Nombre
            </label>
            <input
              id="name"
              name="name"
              placeholder="Tu nombre"
              class="bg-[#F0FFFF] border-[#48D1CC] rounded-xl text-lg font-semibold px-4 py-3 focus:outline-[#20B2AA]"
              title="Ejemplo: Juan PÃ©rez"
            />
          </div>
          <div class="flex flex-col space-y-4">
            <label for="email" class="text-[#008B8B] text-lg font-semibold flex items-center">
              <Icon name="mail" size={ 24 } class="mr-2" />
              Correo electrÃ³nico
            </label>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="tu@email.com"
              class="bg-[#F0FFFF] border-[#48D1CC] rounded-xl text-lg font-semibold px-4 py-3 focus:outline-[#20B2AA]"
              title="Ejemplo: juan.perez@ejemplo.com"
            />
          </div>
          <div class="flex flex-col space-y-4">
            <label for="reason" class="text-[#008B8B] text-lg font-semibold flex items-center">
              <Icon name="category" size={ 24 } class="mr-2" />
              Motivo de contacto
            </label>
            <select
              name="reason"
              class="bg-[#F0FFFF] border-[#48D1CC] rounded-xl text-lg font-semibold px-4 py-3 focus:outline-[#20B2AA]"
              title="Selecciona el motivo de tu contacto"
            >
              <option value="" disabled selected>Selecciona un motivo</option>
              <option value="consulta">ğŸ“ Consulta general</option>
              <option value="soporte">ğŸ› ï¸ Soporte tÃ©cnico</option>
              <option value="ventas">ğŸ’¼ Ventas</option>
              <option value="otro">ğŸ” Otro</option>
            </select>
          </div>
          <div class="flex flex-col space-y-4">
            <label for="message" class="text-[#008B8B] text-lg font-semibold flex items-center">
              <Icon name="message" size={ 24 } class="mr-2" />
              Mensaje
            </label>
            <textarea
              id="message"
              name="message"
              placeholder="Escribe tu mensaje aquÃ­"
              class="bg-[#F0FFFF] border-[#48D1CC] rounded-xl text-lg font-semibold px-4 py-3 min-h-[150px] focus:outline-[#20B2AA]"
            ></textarea>
          </div>
        </div>
        <div class="mt-8 w-full flex justify-end">
          <button
            type="submit"
            class="bg-[#00CED1] hover:bg-[#20B2AA] text-white text-xl py-3 px-4 rounded-xl flex items-center justify-center gap-2"
          >
            <Icon name="send" size={ 35 } />
            Enviar mensaje
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
import { actions } from 'astro:actions'
import Swal from 'sweetalert2'
import { getErrorMessage } from '@/utils'

const form = document.getElementById( 'contact-form' ) as HTMLFormElement

form.addEventListener( 'submit', async ( event ) => {
  event.preventDefault()

  const formData = new FormData( form )

  const { error } = await actions.createContactMessage( formData )

  if ( error ) {
    const errorMessage = getErrorMessage( error )
    Swal.fire( {
      title: 'Error al enviar el mensaje',
      text: errorMessage,
      icon: 'error',
      confirmButtonText: 'Entendido',
    } )
    return
  }
  Swal.fire( {
    title: 'Mensaje enviado',
    text: 'Tu mensaje ha sido enviado con Ã©xito. Nos pondremos en contacto contigo lo antes posible.',
    icon: 'success',
    confirmButtonText: 'Entendido',
  } )
} )


</script>
